#!/usr/bin/env perl
use v5.14;
use utf8;
binmode STDIN, ":utf8";
binmode STDOUT, ":utf8";

undef $/;

my @urls;
@urls = @ARGV if @ARGV;

die <<USAGE unless @urls;

Pass URLs from argv:

   $0 URL URL...

USAGE

use FindBin;
use lib "$FindBin::Bin/lib";
use Ceis::Extractor;

my %queries = (
    qr{http://tw\.news\.yahoo\.com/}     => 'h1, .yom-art-content p',
    qr{tw\.nextmedia\.com/[^/]+/article} => "p, .article_paragraph h1, .article_paragraph h2",
);
my @url_regexes = keys %queries;


for my $url (@ARGV) {
    my $query = "p";

    for my $re (@url_regexes) {
        if ($url =~ m/$re/) {
            $query = $queries{$re};
            last;
        }
    }

    my $extractor = Ceis::Extractor->new(
        url     => $url,
        wanted  => $query
    );

    say "$_\n" for $extractor->sentences;
    say "-" x 42 . "\n\n";
}
